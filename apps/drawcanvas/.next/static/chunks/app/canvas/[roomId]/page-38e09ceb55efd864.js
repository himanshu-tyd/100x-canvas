(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[42],{5355:(t,e,s)=>{Promise.resolve().then(s.bind(s,383)),Promise.resolve().then(s.bind(s,7413))},383:(t,e,s)=>{"use strict";s.d(e,{default:()=>X});var i=s(3475),o=s(1703),l=s(8403);let r=t=>{let{item:e,handleClick:s,currentShape:o,theme:l}=t,r=o===e.name,a="dark"===l;return(0,i.jsxs)("div",{className:"\n        relative cursor-pointer p-2 rounded-md group \n        transition-all duration-300 \n         ".concat(r?a?"bg-[#16161a] hover:bg-indigo-200":"bg-indigo-100 hover:bg-[#9191b1]":a?"bg-[#232329]  hover:bg-[#16161a]":"bg-white hover:bg-indigo-50","\n        "),onClick:()=>s(e.name),onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),s(e.name))},children:[(0,i.jsx)("span",{className:"\n          block relative text-base\n          ".concat(a?"text-slate-200  ":"text-[#232329]","\n          ").concat(r&&!a&&"text-indigo-900","\n        "),children:e.icon}),(0,i.jsx)("span",{className:"\n          capitalize absolute left-1/2 -translate-x-1/2 -bottom-8\n          text-xs py-1 px-2 rounded-md whitespace-nowrap\n          opacity-0 group-hover:opacity-100\n          transition-all duration-200\n          ".concat(a?"bg-[#282830] text-indigo-50":"bg-white text-slate-900 shadow-lg","\n        "),children:e.name})]})};var a=s(830);let h=(0,a.A)("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]),n=(0,a.A)("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]),c=(0,a.A)("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),x=(0,a.A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),d=(0,a.A)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),k=(0,a.A)("MoveRight",[["path",{d:"M18 8L22 12L18 16",key:"1r0oui"}],["path",{d:"M2 12H22",key:"1m8cig"}]]),u=(0,a.A)("Triangle",[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]]),m=(0,a.A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),p=(0,a.A)("Diamond",[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]]),g=[{name:"hand",icon:(0,l.createElement)(h)},{name:"pointer",icon:(0,l.createElement)(n)},{name:"square",icon:(0,l.createElement)(c)},{name:"pencil",icon:(0,l.createElement)(x)},{name:"eclipse",icon:(0,l.createElement)(d)},{name:"arrow",icon:(0,l.createElement)(k)},{name:"triangle",icon:(0,l.createElement)(u)},{name:"line",icon:(0,l.createElement)(m)},{name:"diamond",icon:(0,l.createElement)(p)}],f=[{title:"stroke",element:["1E1E1E","E03131","2F9E44","1971C2","F08C00"]},{title:"background",element:["FFFFFF","FFC9C9","B2F2BB","A5D8FF","FFEC99"]}];var y=s(5398),v=s(6604);let b=async t=>{try{let e=(await y.A.get("/chats/".concat(t))).data;if(!e.success)return v.o.error(e.message),{};let s=e.data;if(!s)return;return null==s?void 0:s.map(t=>(console.log("xx",t),JSON.parse(t.message).shape))}catch(t){return t instanceof Error&&v.o.error(t.message),console.log(t),{}}};class C{setTool(t){this.seletedTool=t}setStrokeColor(t){this.strokeColor="#".concat(t)}setFillColor(t){this.fillColor="#".concat(t)}async inittDraw(){this.existingShapes=await b(this.roomId),this.clearCanvas()}initHandler(){this.socket.onmessage=t=>{let e=JSON.parse(t.data);if("chat"===e.type){let t=JSON.parse(e.message);this.existingShapes.push(t.shape),this.clearCanvas()}}}initMouseHandler(){this.canvas.addEventListener("mousedown",t=>{this.clickMouse=!0;let e=this.getMouseProp(t);this.startX=e.x,this.startY=e.y,this.currentLine=[{x:this.startX,y:this.startY,strokeColor:this.strokeColor}],this.allLines.push(this.currentLine)}),this.canvas.addEventListener("mousemove",t=>{if(!this.clickMouse)return;let e=this.getMouseProp(t),s=e.x-this.startX,i=e.y-this.startY;switch(this.clearCanvas(),this.seletedTool){case"hand":break;case"square":this.ctx.strokeStyle=this.strokeColor,"#FFFFFF"!==this.fillColor&&(this.ctx.fillStyle=this.fillColor,this.ctx.fillRect(this.startX,this.startY,s,i)),this.ctx.strokeRect(this.startX,this.startY,s,i);break;case"eclipse":let o=Math.max(s,i)/2,l=this.startX+o,r=this.startY+o;this.ctx.beginPath(),this.ctx.arc(l,r,Math.abs(o),0,2*Math.PI),"#FFFFFF"!==this.fillColor&&(this.ctx.fillStyle=this.fillColor,this.ctx.fill()),this.ctx.stroke(),this.ctx.closePath();break;case"pencil":this.currentLine.push({x:e.x,y:e.y,strokeColor:this.strokeColor}),this.ctx.beginPath(),this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth=2,this.allLines.forEach(t=>{this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(let e=1;e<t.length;e++)this.ctx.strokeStyle=t[0].strokeColor,this.ctx.lineTo(t[e].x,t[e].y);this.ctx.stroke()});break;case"triangle":this.ctx.beginPath(),this.ctx.moveTo(this.startX,this.startY),this.ctx.lineTo(this.startX-s/2,this.startY+i/2),this.ctx.lineTo(this.startX+s/2,this.startY+i/2),"#FFFFFF"!==this.fillColor&&(this.ctx.fillStyle=this.fillColor,this.ctx.fill()),this.ctx.closePath(),this.ctx.strokeStyle=this.strokeColor,this.ctx.lineWidth=1,this.ctx.stroke();break;case"diamond":this.ctx.beginPath(),this.ctx.moveTo(this.startX,this.startY),this.ctx.lineTo(this.startX-s/2,this.startY+i/2),this.ctx.lineTo(this.startX,this.startY+i),this.ctx.lineTo(this.startX+s/2,this.startY+i/2),"#FFFFFF"!==this.fillColor&&(this.ctx.fillStyle=this.fillColor,this.ctx.fill()),this.ctx.closePath(),this.ctx.strokeStyle=this.strokeColor,this.ctx.lineWidth=1,this.ctx.stroke();break;case"line":this.ctx.beginPath(),this.ctx.strokeStyle=this.strokeColor,this.ctx.moveTo(this.startX,this.startY),this.ctx.lineTo(e.x,e.y),this.ctx.closePath(),this.ctx.lineWidth=1,this.ctx.stroke();break;case"arrow":let a=e.x,h=e.y,n=Math.atan2(i,s),c=a-15*Math.cos(n-Math.PI/6),x=h-15*Math.sin(n-Math.PI/6),d=a-15*Math.cos(n+Math.PI/6),k=h-15*Math.sin(n+Math.PI/6);this.ctx.strokeStyle=this.strokeColor,this.ctx.beginPath(),this.ctx.moveTo(this.startX,this.startY),this.ctx.lineTo(a,h),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(a,h),this.ctx.lineTo(c,x),this.ctx.stroke(),console.log(a,h),this.ctx.beginPath(),this.ctx.moveTo(a,h),this.ctx.lineTo(d,k),this.ctx.stroke()}}),this.canvas.addEventListener("mouseup",t=>{var e;this.clickMouse=!1;let s=this.getMouseProp(t),i=s.x-this.startX,o=s.y-this.startY,l=null;switch(this.seletedTool){case"square":l={type:"square",x:this.startX,y:this.startY,width:i,height:o,isFill:!!(this.fillColor&&"#FFFFFF"!==this.fillColor.toUpperCase()),fillColor:this.fillColor,strokeColor:this.strokeColor};break;case"eclipse":{let t=Math.max(i,o)/2;l={type:"eclipse",centerX:this.startX+t,centerY:this.startY+t,isFill:!!(this.fillColor&&"#FFFFFF"!==this.fillColor.toUpperCase()),fillColor:this.fillColor,strokeColor:this.strokeColor,radius:Math.abs(t)}}break;case"pencil":this.currentLine=[],l={type:"pencil",points:this.allLines,strokeColor:this.strokeColor};break;case"triangle":l={type:"triangle",moveX:this.startX,moveY:this.startY,lineToLeftX:this.startX-i/2,lineToLeftY:this.startY+o/2,lineToRightX:this.startX+i/2,lineToRightY:this.startY+o/2,isFill:"#FFFFFF"!==this.fillColor,fillColor:this.fillColor,strokeColor:this.strokeColor};break;case"diamond":l={type:"diamond",moveX:this.startX,moveY:this.startY,topLeftX:this.startX-i/2,topLeftY:this.startY+o/2,buttonLeftX:this.startX,buttonLeftY:this.startY+o,topRightX:this.startX+i/2,topRightY:this.startY+o/2,isFill:"#FFFFFF"!==this.fillColor,fillColor:this.fillColor,strokeColor:this.strokeColor};break;case"line":l={type:"line",moveX:this.startX,moveY:this.startY,lineToX:s.x,lineToY:s.y,strokeColor:this.strokeColor};break;case"arrow":let r=s.x,a=s.y,h=Math.atan2(o,i),n=r-15*Math.cos(h-Math.PI/6),c=a-15*Math.sin(h-Math.PI/6),x=r-15*Math.cos(h+Math.PI/6),d=a-15*Math.sin(h+Math.PI/6);l={type:"arrow",strokeColor:this.strokeColor,moveToX:this.startX,moveToY:this.startY,mainLineX:r,mainLineY:a,line1MoveToX:r,line1MoveToY:a,line2MoveToX:r,line2MoveToY:a,line1X:n,line1Y:c,line2X:x,line2Y:d}}console.log(l),l&&(null===(e=this.existingShapes)||void 0===e||e.push(l),this.socket.send(JSON.stringify({type:"chat",message:JSON.stringify({shape:l}),roomId:this.roomId})))})}clearCanvas(){var t;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.lineWidth=1,null===(t=this.existingShapes)||void 0===t||t.map(t=>{switch(t.type){case"square":this.ctx.strokeStyle=t.strokeColor,t.isFill&&(this.ctx.fillStyle=t.fillColor,this.ctx.fillRect(t.x,t.y,t.width,t.height)),this.ctx.strokeRect(t.x,t.y,t.width,t.height);break;case"eclipse":this.ctx.beginPath(),this.ctx.arc(t.centerX,t.centerY,t.radius,0,2*Math.PI),t.isFill&&(this.ctx.fillStyle=t.fillColor,this.ctx.fill()),this.ctx.strokeStyle=t.strokeColor,this.ctx.stroke(),this.ctx.closePath();break;case"triangle":this.ctx.beginPath(),this.ctx.moveTo(t.moveX,t.moveY),this.ctx.lineTo(t.lineToLeftX,t.lineToLeftY),this.ctx.lineTo(t.lineToRightX,t.lineToRightY),t.isFill&&(this.ctx.fillStyle=t.fillColor,this.ctx.fill()),this.ctx.closePath(),this.ctx.strokeStyle=t.strokeColor,this.ctx.stroke();break;case"diamond":this.ctx.beginPath(),this.ctx.moveTo(t.moveX,t.moveY),this.ctx.lineTo(t.topLeftX,t.topLeftY),this.ctx.lineTo(t.buttonLeftX,t.buttonLeftY),this.ctx.lineTo(t.topRightX,t.topRightY),t.isFill&&(this.ctx.fillStyle=t.fillColor,this.ctx.fill()),this.ctx.closePath(),this.ctx.strokeStyle=t.strokeColor,this.ctx.stroke();break;case"line":this.ctx.beginPath(),this.ctx.strokeStyle=t.strokeColor,this.ctx.moveTo(t.moveX,t.moveY),this.ctx.lineTo(t.lineToX,t.lineToY),this.ctx.closePath(),this.ctx.stroke();break;case"arrow":this.ctx.beginPath(),this.ctx.strokeStyle=t.strokeColor,this.ctx.moveTo(t.moveToX,t.moveToY),this.ctx.lineTo(t.mainLineX,t.mainLineY),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t.line1MoveToX,t.line1MoveToY),this.ctx.lineTo(t.line1X,t.line1Y),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t.line2MoveToX,t.line2MoveToY),this.ctx.lineTo(t.line2X,t.line2Y),this.ctx.stroke();break;case"pencil":t.points.forEach(t=>{this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(let e=1;e<t.length;e++)this.ctx.strokeStyle=t[0].strokeColor,this.ctx.lineTo(t[e].x,t[e].y);this.ctx.stroke()})}})}constructor(t,e,s){this.seletedTool=null,this.strokeColor="",this.fillColor="",this.allLines=[],this.currentLine=[],this.getMouseProp=t=>{let e=this.canvas.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}},this.canvas=t,this.ctx=t.getContext("2d"),this.existingShapes=[],this.roomId=e,this.socket=s,this.clickMouse=!1,this.startX=0,this.startY=0,this.inittDraw(),this.initHandler(),this.initMouseHandler()}}let F=t=>{let{items:e,selectedBackground:s,setSelectedBackground:o,selectedColor:r,setSelectedColor:a}=t,[h,n]=(0,l.useState)(!1),[c,x]=(0,l.useState)(!1);console.log("strroke",r);let d=(t,e)=>{"stroke"===e&&(a(t||"1E1E1E"),n(!0),x(!1)),"background"===e&&(o(t),x(!0),n(!1))};return console.log(s,r),(0,i.jsxs)("div",{className:"flex flex-col px-2 py-3 font-normal text-[10px] capitalize space-y-1",children:[(0,i.jsx)("span",{children:e.title}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[e.element.map(t=>(0,i.jsx)("div",{onClick:()=>d(t,e.title),className:"w-6 h-6 cursor-pointer rounded-md border border-gray-300 hover:border hover:border-gray-700 p-1  ",style:{backgroundColor:"#".concat(t)}},t)),(0,i.jsx)("div",{className:"w-[2px] h-2 rounded-lg bg-gray-300"}),(0,i.jsx)("div",{className:"w-7 h-7  rounded-md outline-2 outline-indigo-100 outline ",style:{backgroundColor:h?"#".concat(r||"1E1E1E"):c?"#".concat(s||"transparent"):"transparent"}})]})]})},w=(0,a.A)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),T=(0,a.A)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),M=t=>{let{roomId:e,socket:s}=t,o=(0,l.useRef)(null),[a,h]=(0,l.useState)(null),[n,c]=(0,l.useState)(),[x,d]=(0,l.useState)({w:window.innerWidth,h:window.innerHeight}),[k,u]=(0,l.useState)("1E1E1E"),[m,p]=(0,l.useState)("FFFFFF"),[y,v]=(0,l.useState)("light"),b="light"===y;(0,l.useEffect)(()=>{let t=()=>{d({h:window.innerHeight,w:window.innerWidth})};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),(0,l.useEffect)(()=>{null==n||n.setTool(a),null==n||n.setStrokeColor(k),null==n||n.setFillColor(m)},[a,n,k,m]),(0,l.useEffect)(()=>{o.current&&c(new C(o.current,e,s))},[o,e,s]);let M=t=>{h(t)};return(0,i.jsxs)("div",{className:"flex w-screen h-screen justify-center",children:[(0,i.jsx)("div",{className:"\n        p-2 flex items-center justify-center gap-2 \n        fixed top-4 left-1/2 -translate-x-1/2 z-20\n        rounded-xl shadow-lg\n        ".concat(b?"bg-white/95 border border-slate-200":"bg-[#232329] border border-slate-700","\n        backdrop-blur-sm transition-colors duration-300\n      "),children:g.map((t,e)=>(0,i.jsx)(r,{item:t,currentShape:a,handleClick:M,theme:y},e))}),(0,i.jsx)("div",{className:"w-[212px] z-20 h-[468px] rounded-lg top-0 shadow-sm fixed left-0 translate-x-5 translate-y-[calc(100%-75%)] \n          ".concat(b?"bg-white border-slate-200 border-[.4px]":"bg-[#232329] text-white border-slate-700 border-[.4px]"),children:f.map((t,e)=>(0,i.jsx)(F,{items:{title:t.title,element:[...t.element]},selectedBackground:m,setSelectedBackground:p,setSelectedColor:u,selectedColor:k},e))}),(0,i.jsx)("div",{className:"fixed top-5 z-20 right-5 -translate-x-5 rounded-full  shadow-md border  p-2 flex items-center justify-center clicked-effect ".concat(b?"bg-white/95 border-slate-200 ":"bg-[#232329] text-white/95 border-slate-500 "," "),children:(0,i.jsx)("button",{onClick:()=>{v("light"===y?"dark":"light")},"aria-label":"Switch to ".concat(b?"dark":"light"," mode"),children:b?(0,i.jsx)(w,{}):(0,i.jsx)(T,{})})}),(0,i.jsx)("canvas",{ref:o,height:x.h,width:x.w,className:"fixed block ".concat(b?"bg-slate-50":"bg-[#121212]")})]})};var Y=s(7413);let X=t=>{let{roomId:e}=t,[s,r]=(0,l.useState)(null);return((0,l.useEffect)(()=>{let t=new WebSocket("".concat(o.k,"?token=").concat(Y.Sh));t.onopen=()=>{r(t),t.send(JSON.stringify({type:"join_room",roomId:e}))}},[e]),s)?(0,i.jsx)(M,{roomId:e,socket:s}):(0,i.jsx)("div",{className:"flex w-screen h-screen items-center justify-center",children:(0,i.jsx)("span",{className:"text-purple-600 ",children:"We are getting you shape please wait.\uD83D\uDE42"})})}},5398:(t,e,s)=>{"use strict";s.d(e,{A:()=>l});var i=s(9608),o=s(1703);let l=i.A.create({baseURL:o.T,withCredentials:!0})},1703:(t,e,s)=>{"use strict";s.d(e,{T:()=>i,k:()=>o});let i="http://localhost:3001",o="ws://localhost:8080"},7413:(t,e,s)=>{"use strict";s.d(e,{Bl:()=>i,S$:()=>o,Sh:()=>r,user:()=>l});let i=()=>new Date().getFullYear(),o=!1,l=(()=>{if(!o)return JSON.parse(localStorage.getItem("user")||"{}")})(),r=(()=>{if(!o)return localStorage.getItem("token")})()},830:(t,e,s)=>{"use strict";s.d(e,{A:()=>h});var i=s(8403);let o=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=function(){for(var t=arguments.length,e=Array(t),s=0;s<t;s++)e[s]=arguments[s];return e.filter((t,e,s)=>!!t&&""!==t.trim()&&s.indexOf(t)===e).join(" ").trim()};var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(0,i.forwardRef)((t,e)=>{let{color:s="currentColor",size:o=24,strokeWidth:a=2,absoluteStrokeWidth:h,className:n="",children:c,iconNode:x,...d}=t;return(0,i.createElement)("svg",{ref:e,...r,width:o,height:o,stroke:s,strokeWidth:h?24*Number(a)/Number(o):a,className:l("lucide",n),...d},[...x.map(t=>{let[e,s]=t;return(0,i.createElement)(e,s)}),...Array.isArray(c)?c:[c]])}),h=(t,e)=>{let s=(0,i.forwardRef)((s,r)=>{let{className:h,...n}=s;return(0,i.createElement)(a,{ref:r,iconNode:e,className:l("lucide-".concat(o(t)),h),...n})});return s.displayName="".concat(t),s}}},t=>{var e=e=>t(t.s=e);t.O(0,[604,227,568,395,358],()=>e(5355)),_N_E=t.O()}]);